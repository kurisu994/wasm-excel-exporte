<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŸºæœ¬å¯¼å‡ºç¤ºä¾‹ - excel-exporter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            max-width: 800px;
            width: 100%;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        tr:last-child td {
            border-bottom: none;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(240, 147, 251, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(79, 172, 254, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .info-box h3 {
            color: #2196F3;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .info-box p {
            color: #555;
            line-height: 1.6;
            font-size: 14px;
        }

        .code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        .error {
            background: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            display: none;
        }

        .error.show {
            display: block;
        }

        .error h3 {
            color: #f44336;
            margin-bottom: 8px;
        }

        .success {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            display: none;
        }

        .success.show {
            display: block;
        }

        .success h3 {
            color: #4caf50;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ åŸºæœ¬å¯¼å‡ºç¤ºä¾‹</h1>
        <p class="subtitle">æ¼”ç¤º excel-exporter çš„åŸºæœ¬åŠŸèƒ½</p>

        <div class="info-box">
            <h3>ğŸ“‹ åŠŸèƒ½è¯´æ˜</h3>
            <p>
                è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <span class="code">export_table_to_csv()</span> å‡½æ•°å°† HTML è¡¨æ ¼å¯¼å‡ºä¸º CSV æ–‡ä»¶ã€‚
                ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ–‡ä»¶åå¯¼å‡ºè¡¨æ ¼ã€‚
            </p>
        </div>

        <table id="employees-table">
            <thead>
                <tr>
                    <th>å‘˜å·¥ç¼–å·</th>
                    <th>å§“å</th>
                    <th>éƒ¨é—¨</th>
                    <th>èŒä½</th>
                    <th>å…¥èŒæ—¥æœŸ</th>
                    <th>è–ªèµ„</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>E001</td>
                    <td>å¼ ä¸‰</td>
                    <td>æŠ€æœ¯éƒ¨</td>
                    <td>é«˜çº§å·¥ç¨‹å¸ˆ</td>
                    <td>2020-03-15</td>
                    <td>Â¥15,000</td>
                </tr>
                <tr>
                    <td>E002</td>
                    <td>æå››</td>
                    <td>å¸‚åœºéƒ¨</td>
                    <td>å¸‚åœºç»ç†</td>
                    <td>2019-07-22</td>
                    <td>Â¥18,000</td>
                </tr>
                <tr>
                    <td>E003</td>
                    <td>ç‹äº”</td>
                    <td>äººäº‹éƒ¨</td>
                    <td>HR ä¸“å‘˜</td>
                    <td>2021-01-10</td>
                    <td>Â¥12,000</td>
                </tr>
                <tr>
                    <td>E004</td>
                    <td>èµµå…­</td>
                    <td>æŠ€æœ¯éƒ¨</td>
                    <td>å‰ç«¯å¼€å‘</td>
                    <td>2022-05-08</td>
                    <td>Â¥13,000</td>
                </tr>
                <tr>
                    <td>E005</td>
                    <td>å­™ä¸ƒ</td>
                    <td>è´¢åŠ¡éƒ¨</td>
                    <td>è´¢åŠ¡ä¸»ç®¡</td>
                    <td>2018-11-30</td>
                    <td>Â¥20,000</td>
                </tr>
            </tbody>
        </table>

        <div class="button-group">
            <button class="btn-primary" onclick="exportWithDefaultName()">
                ğŸ“¥ å¯¼å‡ºï¼ˆé»˜è®¤æ–‡ä»¶åï¼‰
            </button>
            <button class="btn-secondary" onclick="exportWithCustomName()">
                ğŸ“ å¯¼å‡ºï¼ˆè‡ªå®šä¹‰æ–‡ä»¶åï¼‰
            </button>
            <button class="btn-success" onclick="exportWithDate()">
                ğŸ“… å¯¼å‡ºï¼ˆå¸¦æ—¥æœŸï¼‰
            </button>
        </div>

        <div class="success" id="success-message">
            <h3>âœ… å¯¼å‡ºæˆåŠŸï¼</h3>
            <p>æ–‡ä»¶å·²å¼€å§‹ä¸‹è½½ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨çš„ä¸‹è½½æ–‡ä»¶å¤¹ã€‚</p>
        </div>

        <div class="error" id="error-message">
            <h3>âŒ å¯¼å‡ºå¤±è´¥</h3>
            <p id="error-text"></p>
        </div>

        <div class="info-box" style="margin-top: 30px;">
            <h3>ğŸ’¡ ä½¿ç”¨æç¤º</h3>
            <p>
                â€¢ é»˜è®¤æ–‡ä»¶åï¼šä½¿ç”¨ <span class="code">table_export.csv</span><br>
                â€¢ è‡ªå®šä¹‰æ–‡ä»¶åï¼šå¯ä»¥æŒ‡å®šä»»æ„åˆæ³•çš„æ–‡ä»¶å<br>
                â€¢ å¸¦æ—¥æœŸï¼šè‡ªåŠ¨åœ¨æ–‡ä»¶åä¸­æ·»åŠ å½“å‰æ—¥æœŸ<br>
                â€¢ æ‰€æœ‰å¯¼å‡ºçš„æ–‡ä»¶éƒ½æ˜¯ UTF-8 ç¼–ç çš„ CSV æ ¼å¼
            </p>
        </div>
    </div>

    <script type="module">
        import init, { export_table_to_csv } from '../pkg/wasm_excel_exporter.js';

        // åˆå§‹åŒ– WASM æ¨¡å—
        let wasmInitialized = false;
        async function initWasm() {
            if (!wasmInitialized) {
                try {
                    await init();
                    wasmInitialized = true;
                    console.log('âœ… WASM æ¨¡å—åˆå§‹åŒ–æˆåŠŸ');
                } catch (error) {
                    showError('WASM æ¨¡å—åˆå§‹åŒ–å¤±è´¥: ' + error);
                    throw error;
                }
            }
        }

        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        function showSuccess() {
            const successDiv = document.getElementById('success-message');
            const errorDiv = document.getElementById('error-message');
            errorDiv.classList.remove('show');
            successDiv.classList.add('show');
            setTimeout(() => {
                successDiv.classList.remove('show');
            }, 3000);
        }

        // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
        function showError(message) {
            const errorDiv = document.getElementById('error-message');
            const successDiv = document.getElementById('success-message');
            const errorText = document.getElementById('error-text');
            successDiv.classList.remove('show');
            errorText.textContent = message;
            errorDiv.classList.add('show');
        }

        // å¯¼å‡ºå‡½æ•° - ä½¿ç”¨é»˜è®¤æ–‡ä»¶å
        window.exportWithDefaultName = async function() {
            try {
                await initWasm();
                export_table_to_csv('employees-table');
                showSuccess();
                console.log('ğŸ“¥ å¯¼å‡ºæˆåŠŸï¼ˆé»˜è®¤æ–‡ä»¶åï¼‰');
            } catch (error) {
                showError('å¯¼å‡ºå¤±è´¥: ' + error);
                console.error('âŒ å¯¼å‡ºå¤±è´¥:', error);
            }
        };

        // å¯¼å‡ºå‡½æ•° - ä½¿ç”¨è‡ªå®šä¹‰æ–‡ä»¶å
        window.exportWithCustomName = async function() {
            try {
                await initWasm();
                export_table_to_csv('employees-table', 'å‘˜å·¥ä¿¡æ¯è¡¨.csv');
                showSuccess();
                console.log('ğŸ“¥ å¯¼å‡ºæˆåŠŸï¼ˆè‡ªå®šä¹‰æ–‡ä»¶åï¼‰');
            } catch (error) {
                showError('å¯¼å‡ºå¤±è´¥: ' + error);
                console.error('âŒ å¯¼å‡ºå¤±è´¥:', error);
            }
        };

        // å¯¼å‡ºå‡½æ•° - ä½¿ç”¨å¸¦æ—¥æœŸçš„æ–‡ä»¶å
        window.exportWithDate = async function() {
            try {
                await initWasm();
                const today = new Date().toISOString().split('T')[0];
                const filename = `å‘˜å·¥ä¿¡æ¯_${today}.csv`;
                export_table_to_csv('employees-table', filename);
                showSuccess();
                console.log('ğŸ“¥ å¯¼å‡ºæˆåŠŸï¼ˆå¸¦æ—¥æœŸï¼‰:', filename);
            } catch (error) {
                showError('å¯¼å‡ºå¤±è´¥: ' + error);
                console.error('âŒ å¯¼å‡ºå¤±è´¥:', error);
            }
        };

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        initWasm().catch(error => {
            console.error('åˆå§‹åŒ–å¤±è´¥:', error);
        });
    </script>
</body>
</html>

