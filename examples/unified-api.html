<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç»Ÿä¸€å¯¼å‡ºAPIç¤ºä¾‹ - excel-exporter</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        padding: 40px 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        padding: 40px;
        border-radius: 12px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }

      h1 {
        color: #333;
        margin-bottom: 10px;
        font-size: 32px;
      }

      .subtitle {
        color: #666;
        margin-bottom: 30px;
        font-size: 14px;
      }

      .info-box {
        background: #f0f7ff;
        border-left: 4px solid #667eea;
        padding: 15px 20px;
        margin-bottom: 30px;
        border-radius: 4px;
      }

      .info-box h3 {
        color: #667eea;
        margin-bottom: 10px;
        font-size: 16px;
      }

      .info-box code {
        background: #e8f0fe;
        padding: 2px 8px;
        border-radius: 3px;
        font-family: "Courier New", monospace;
        color: #5f6368;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      th,
      td {
        padding: 12px 15px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }

      th {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 13px;
        letter-spacing: 0.5px;
      }

      tr:hover {
        background-color: #f8f9fa;
      }

      .button-group {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        margin: 30px 0;
      }

      button {
        padding: 12px 24px;
        font-size: 14px;
        font-weight: 600;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        min-width: 140px;
      }

      .btn-csv {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-csv:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
      }

      .btn-excel {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
      }

      .btn-excel:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
      }

      .btn-default {
        background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
        color: white;
      }

      .btn-default:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(108, 117, 125, 0.4);
      }

      button:active {
        transform: translateY(0);
      }

      .code-section {
        margin-top: 40px;
        background: #1e1e1e;
        color: #d4d4d4;
        padding: 20px;
        border-radius: 8px;
        overflow-x: auto;
      }

      .code-section pre {
        margin: 0;
        font-family: "Courier New", monospace;
        font-size: 13px;
        line-height: 1.6;
      }

      .code-section .comment {
        color: #6a9955;
      }

      .code-section .keyword {
        color: #569cd6;
      }

      .code-section .string {
        color: #ce9178;
      }

      .code-section .function {
        color: #dcdcaa;
      }

      footer {
        text-align: center;
        margin-top: 40px;
        color: #666;
        font-size: 14px;
      }

      footer a {
        color: #667eea;
        text-decoration: none;
      }

      footer a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸš€ ç»Ÿä¸€å¯¼å‡ºAPIç¤ºä¾‹</h1>
      <p class="subtitle">
        excel-exporter v1.2.1 - ä½¿ç”¨æ–°çš„ <code>export_table()</code> å‡½æ•°
      </p>

      <div class="info-box">
        <h3>âœ¨ æ–°ç‰¹æ€§ï¼šç»Ÿä¸€çš„å¯¼å‡ºæ¥å£</h3>
        <p>
          ç°åœ¨åªéœ€è¦ä¸€ä¸ªå‡½æ•° <code>export_table(table_id, filename, format)</code> å°±å¯ä»¥å¯¼å‡ºä¸ºä¸åŒæ ¼å¼ï¼š
        </p>
        <ul style="margin-top: 10px; padding-left: 20px">
          <li><code>ExportFormat.Csv</code> - CSV æ ¼å¼ï¼ˆé»˜è®¤ï¼‰</li>
          <li><code>ExportFormat.Xlsx</code> - Excel æ ¼å¼</li>
        </ul>
      </div>

      <table id="my-table">
        <thead>
          <tr>
            <th>å§“å</th>
            <th>éƒ¨é—¨</th>
            <th>èŒä½</th>
            <th>å·¥å·</th>
            <th>é‚®ç®±</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>å¼ ä¸‰</td>
            <td>æŠ€æœ¯éƒ¨</td>
            <td>é«˜çº§å·¥ç¨‹å¸ˆ</td>
            <td>E10001</td>
            <td>zhangsan@example.com</td>
          </tr>
          <tr>
            <td>æå››</td>
            <td>äº§å“éƒ¨</td>
            <td>äº§å“ç»ç†</td>
            <td>P20002</td>
            <td>lisi@example.com</td>
          </tr>
          <tr>
            <td>ç‹äº”</td>
            <td>è®¾è®¡éƒ¨</td>
            <td>UIè®¾è®¡å¸ˆ</td>
            <td>D30003</td>
            <td>wangwu@example.com</td>
          </tr>
          <tr>
            <td>èµµå…­</td>
            <td>å¸‚åœºéƒ¨</td>
            <td>å¸‚åœºä¸“å‘˜</td>
            <td>M40004</td>
            <td>zhaoliu@example.com</td>
          </tr>
          <tr>
            <td>å­™ä¸ƒ</td>
            <td>äººåŠ›èµ„æºéƒ¨</td>
            <td>HRç»ç†</td>
            <td>H50005</td>
            <td>sunqi@example.com</td>
          </tr>
        </tbody>
      </table>

      <div class="button-group">
        <button class="btn-default" onclick="exportDefault()">
          ğŸ“„ é»˜è®¤å¯¼å‡ºï¼ˆCSVï¼‰
        </button>
        <button class="btn-csv" onclick="exportCsv()">
          ğŸ“Š å¯¼å‡ºä¸º CSV
        </button>
        <button class="btn-excel" onclick="exportExcel()">
          ğŸ“— å¯¼å‡ºä¸º Excel
        </button>
      </div>

      <div class="code-section">
        <pre><code><span class="comment">// å¯¼å…¥æ¨¡å—</span>
<span class="keyword">import</span> init, { <span class="function">export_table</span>, ExportFormat } <span class="keyword">from</span> <span class="string">'./pkg/excel_exporter.js'</span>;

<span class="comment">// åˆå§‹åŒ– WebAssemblyï¼ˆåªéœ€ä¸€æ¬¡ï¼‰</span>
<span class="keyword">await</span> <span class="function">init</span>();

<span class="comment">// æ–¹å¼ 1ï¼šé»˜è®¤å¯¼å‡ºä¸º CSVï¼ˆä¸ä¼  format å‚æ•°ï¼‰</span>
<span class="function">export_table</span>(<span class="string">'my-table'</span>);  <span class="comment">// â†’ table_export.csv</span>
<span class="function">export_table</span>(<span class="string">'my-table'</span>, <span class="string">'å‘˜å·¥æ•°æ®'</span>);  <span class="comment">// â†’ å‘˜å·¥æ•°æ®.csv</span>

<span class="comment">// æ–¹å¼ 2ï¼šæ˜¾å¼æŒ‡å®šä¸º CSV</span>
<span class="function">export_table</span>(<span class="string">'my-table'</span>, <span class="string">'å‘˜å·¥æ•°æ®'</span>, ExportFormat.Csv);

<span class="comment">// æ–¹å¼ 3ï¼šå¯¼å‡ºä¸º Excel</span>
<span class="function">export_table</span>(<span class="string">'my-table'</span>, <span class="string">'å‘˜å·¥æ•°æ®'</span>, ExportFormat.Xlsx);  <span class="comment">// â†’ å‘˜å·¥æ•°æ®.xlsx</span>
</code></pre>
      </div>

      <footer>
        <p>
          Made with â¤ï¸ using
          <a
            href="https://github.com/kurisu994/excel-exporter"
            target="_blank"
            >excel-exporter</a
          >
        </p>
        <p style="margin-top: 10px; font-size: 12px">
          ğŸ¦€ Powered by Rust + WebAssembly
        </p>
      </footer>
    </div>

    <script type="module">
      import init, {
        export_table,
        ExportFormat,
      } from "../pkg/excel_exporter.js";

      // åˆå§‹åŒ– WebAssembly
      await init();

      // æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸä¾›æŒ‰é’®ä½¿ç”¨
      window.exportDefault = () => {
        export_table("my-table"); // é»˜è®¤ CSV
        console.log("âœ… é»˜è®¤å¯¼å‡ºå®Œæˆï¼ˆCSVæ ¼å¼ï¼‰");
      };

      window.exportCsv = () => {
        export_table("my-table", "å‘˜å·¥æ•°æ®", ExportFormat.Csv);
        console.log("âœ… CSV å¯¼å‡ºå®Œæˆ");
      };

      window.exportExcel = () => {
        export_table("my-table", "å‘˜å·¥æ•°æ®", ExportFormat.Xlsx);
        console.log("âœ… Excel å¯¼å‡ºå®Œæˆ");
      };

      console.log("ğŸš€ WebAssembly å·²åˆå§‹åŒ–ï¼Œå¯ä»¥ä½¿ç”¨å¯¼å‡ºåŠŸèƒ½");
    </script>
  </body>
</html>
